<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="EnvironmentValidator.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:EnvironmentValidator"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto"/>
        </Grid.RowDefinitions>

        <!-- Indicador de loading -->
        <StackPanel x:Name="LoadingPanel" Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="20,30,0,0" Visibility="Collapsed">
            <TextBlock Text="Validando o ambiente, por favor aguarde..." FontSize="20" HorizontalAlignment="Center"/>
            <ProgressBar IsIndeterminate="True" Width="300" Height="20" Margin="0,10,0,0"/>
            <TextBlock Text="{Binding StatusMessage, Mode=OneWay}"
             FontSize="12"
             Margin="0,10,0,0"
             Foreground="Orange"
             HorizontalAlignment="left"/>
        </StackPanel>
        
        
        <!-- Tela Inicial de Preenchimento do Token -->
        <StackPanel x:Name="ViewInitialPanel" Grid.Row="0" HorizontalAlignment="left" VerticalAlignment="Center" Margin="20,30,0,0" >
            <TextBlock Text="> Workplace to Viva Now - Ferramenta de Análise" FontSize="36" FontWeight="Bold" Margin="0,0,0,20"/>

            <Border BorderBrush="Gray" BorderThickness="0,4,0,0" Width="2048" Margin="-100,0,0,0"/>
            <ProgressBar Grid.Row="1" IsIndeterminate="False" Minimum="0" Maximum="100" Value="50" Height="50" Width="750" HorizontalAlignment="left" VerticalAlignment="Center" Margin="190,0,0,20"/>
            
            
            <TextBlock Text="Olá!" FontSize="32" FontWeight="Bold" TextAlignment="Left" Margin="200,50,0,0"/>
            <TextBlock Text="Bem-vindo à ferramenta de migração do Workplace para o Microsoft Viva Engage." 
                    FontSize="20" 
                    TextAlignment="Left" 
                    Margin="200,10,0,0"/>
            <TextBlock Text="Para iniciar insira o token do AppRegistration gerado no Workplace" 
                    FontSize="16" 
                    Margin="200,5,0,20"/>

            <!-- Hyperlink to a web page -->
            <HyperlinkButton Content="* Como criar integrações personalizadas?" NavigateUri="https://developers.facebook.com/docs/workplace/custom-integrations-new?locale=pt_BR" Margin="200,0,0,20"/>

            <TextBox x:Name="inputTokenWorkplace" HorizontalAlignment="Left" Width="730" Height="40" PlaceholderText="XXXXX-XXX-XXX-XXXX" TextAlignment="Left" Margin="200,0,0,0"/>
            <Button x:Name="btnTokenWorkplace" Click="getTokenWorkplace" Width="300" Height="40" HorizontalAlignment="Left" FontSize="16" Margin="200,20,0,0">Continuar</Button>
        </StackPanel>
        <!-- FIM da Tela Inicial de Preenchimento do Token -->
        
        <!-- Tela de Validação do Token -->
        <StackPanel x:Name="ViewValidateTokenWorkplace" Grid.Row="0" HorizontalAlignment="left" VerticalAlignment="Center" Margin="20,30,0,0" Visibility="Collapsed">
            <TextBlock Text="Token validado com sucesso!" 
        FontSize="16" 
        Margin="200,5,0,20"/>
        </StackPanel>
        <!-- FIM Tela de Validação do Token -->
        
    </Grid>
</Window>
